---
title: "LETKFの「L」"
date: 2019-06-09T23:16:31+09:00
draft: false
type: post
---


アンサンブルカルマンフィルタにおいて解析を局所的に行うということが、しばらくの間は何となく素直に納得できなかった。<br>
<br>
最適な推定値を求めるといったときに、その「最適」の尺度として全体についての単一の尺度を使うのではなく、
領域の中の部分ごとに異なる複数の尺度を同時に使うという発想は自然なものだと思う。<br>
そのおかげで、東京の予報を最適にするために京都の予報の精度を少し下げる必要があるというような状態は起こらない。<br>
ただし、背景誤差の表現のためのアンサンブルはあくまで領域全体についての予報値であり、領域全体の都合に従った性質を持つはずで、それを
部分ごとにバラバラにしてそれぞれの部分ごとの都合に応じた異なる組み合わせ方をすることは、
手法としての一貫性を損なっているのではないかという疑問があった。<br>
<br>
直感的には、WKB近似などと同じように「異なる複数の前提を使って都合よくいいとこ取りをしている」手法であるように思える。
ではその「いいとこ取り」が成り立つための都合のいい前提とは何か？<br>
<br>
局所低次元性(Patil et al. 2001)という性質があるが、それと同時に、
「局所的な解析によってより高次元の表現ができる」と言われることもあるのがややこしい。<br>
<br>
根拠とされているのは局所低次元性であるが、その背景には領域内の場の時間発展の複スケール性がある。<br>
すなわち、予報をする領域を東西方向に適切な大きさの小領域に区切ったときに、それぞれの小領域の中でそれぞれ独立に摂動が成長する
とみなすことができる部分が、大気の変動の大部分を占めているということである。<br>
たとえば小領域の中での次の6時間の推移のしかたに分岐があって、同じような初期値からとりうる状態が2通りあるとしたら、
同様の小領域4つからなる全体のとりうる状態は16通りになる。<br>
<br>
このような状態は、力学系の入門書で最初に教わる、系の複雑さを議論するためのLyapunov次元などの概念的なイメージとはかなり異なっている。<br>
実際のところは、系がひとかたまりとして動くというよりは、
それぞれ勝手な都合で動く複数の系を集めてきて一つの系であるように見なしているという状態に近い。<br>
<br>
この性質は必要なアンサンブルメンバーの数を考えるうえで大きな意味を持つ。<br>
先の例だと、主要な摂動成長の構造が各領域で2通りずつあるとしたら、系全体では16通りの組み合わせがある。<br>
もし系全体で一つの解析値を作るために同化を行うなら、起こりうる構造を表現するためにアンサンブルメンバーは少なくとも16個要ることになる。<br>
解析を局所化する場合はどうか。16メンバーのアンサンブルがあっても、
その中で各領域で実際に違いをもたらすのは2種類の構造だけであり、他は重複している。もっと減らしてもよいはずである。<br>
アンサンブルメンバーのうち2種類の構造を含んでいるものを見つけ出せればよいのだから、確率的なばらつきを考慮しても、
16個よりはずっと少ない数で十分に目的を達することができる。<br>
<br>
これが、「局所的に低次元である」ことと同時に「解析の局所化によってアンサンブルメンバー数より高い次元の構造を表現できる」ことの種明かしである。
<br>
1000個の漢字を覚えるのは大変だが、同じ1000通りの違うものを表現するのに3つの数字の組を使えば10種類の数字を覚えるだけで済む、
と考えればわかりやすいかもしれない。
<br>
<br>
実際の状況では、局所低次元性が「ある程度」成り立つくらい局所的なふるまい方をしており、
なおかつ同時に「ある程度」系全体に及ぶような構造の予報期間内の変動も存在する、というような中間の状態にあることが想定される。<br>
そのために、全体についての予報モデルの結果としてのアンサンブルメンバーの重ね合わせで解析値を表現できるとし（LETKFの"T"）、
ただしその重ね合わせ方は局所的にそれぞれ異なっていてもよいとする(LETKFの"L")、という方法をとることができる。<br>
<br>

個人的にはLETKFは洗練されたエレガントな手法であり、アンサンブルカルマンフィルタの完成形の一つであると思う。<br>

実際に時空間分布する物理量を予測する気象のようなモデルでは、モデルの出力の目的や注目点が使う人によって様々であったりする。
全体の気圧配置を見たい人もいれば、ある地点の天気に注目する人もいるし、
3時間後の予報も24時間後の予報も同じくらい重要性をもって見られる。
<br>
実際の運用上で必要となる、全体と部分の柔軟な使い分けに対して、LETKFはLocalとTransformを両方備えていることによってうまく対応している手法であるように思う。


